param($path = "C:\Temp"); if(!(test-path $path)){Write-Information -MessageData "Path does not exist. Creating Path..." -InformationAction Continue; New-Item -ItemType Directory -Force -Path $path | Out-Null; Write-Information -MessageData "...Complete" -InformationAction Continue}; Set-Location $path; [System.Net.ServicePointManager]::SecurityProtocol = [System.Net.SecurityProtocolType]::Tls12; Invoke-WebRequest -Uri https://download.sysinternals.com/files/Sysmon.zip -UseBasic -Outfile Sysmon.zip; Expand-Archive Sysmon.zip -Force; Set-Location $path\Sysmon; Invoke-WebRequest -Uri https://raw.githubusercontent.com/Cyber74-Brian-McCaleb/sysmon-modular/master/c74prod.xml -UseBasic -Outfile sysmonconfig-export.xml; .\sysmon.exe -accepteula -i sysmonconfig-export.xml; .\sysmon.exe -accepteula -c sysmonconfig-export.xml